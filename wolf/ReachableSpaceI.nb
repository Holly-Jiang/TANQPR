(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14041,        330]
NotebookOptionsPosition[     13129,        308]
NotebookOutlinePosition[     13484,        324]
CellTagsIndexPosition[     13441,        321]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ReachableSpaceI", "[", 
      RowBox[{"Operas1_", ",", "Meas1_", ",", "Inibais1_", ",", "Dimes1_"}], 
      "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Operas", "=", "Operas1"}], ",", 
         RowBox[{"Meas", "=", "Meas1"}], ",", 
         RowBox[{"inibasis", "=", "Inibais1"}], ",", 
         RowBox[{"dimes", "=", "Dimes1"}], ",", "B0", ",", "B1", ",", "B2", 
         ",", "averas", ",", "Vlist", ",", "orth", ",", "temp1", ",", "temp2",
          ",", "flag"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"averas", "=", 
         RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"averas", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Operas", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], ".", 
               RowBox[{"Meas", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"Operas", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "Operas", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"B0", "=", 
         RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"B1", "=", 
         RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"orth", "=", 
         RowBox[{"Orthogonalize", "[", "inibasis", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"B1", ",", 
            RowBox[{"orth", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "orth", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"B2", "=", "B1"}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Position", "[", 
                  RowBox[{"B0", ",", 
                   RowBox[{"B1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], "<=", 
                "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Vlist", "=", 
                 RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Do", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"temp1", "=", 
                    RowBox[{
                    RowBox[{"averas", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ".", 
                    RowBox[{"B1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"temp2", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", "dimes"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"temp2", "+=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"B2", "[", 
                    RowBox[{"[", "s", "]"}], "]"}], ".", "temp1"}], "*", 
                    RowBox[{"B2", "[", 
                    RowBox[{"[", "s", "]"}], "]"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"Length", "[", "B2", "]"}]}], "}"}]}], "]"}], ";",
                    "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"Vlist", ",", 
                    RowBox[{"temp1", "-", "temp2"}]}], "]"}], ";"}], 
                  "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"Length", "[", "averas", "]"}]}], "}"}]}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"orth", "=", 
                 RowBox[{"Orthogonalize", "[", "Vlist", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"flag", "=", "True"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Do", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"B2", ",", 
                    RowBox[{"orth", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], "]"}], "<=", 
                    "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"orth", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], "\[NotEqual]", 
                    "0"}]}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"B2", ",", 
                    RowBox[{"orth", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"flag", "=", "False"}]}], ","}], " ", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", 
                    RowBox[{"Length", "[", "orth", "]"}]}], "}"}]}], "]"}], 
                ";"}], "\[IndentingNewLine]", ",", 
               RowBox[{"Continue", "[", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "B1", "]"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "B1", "]"}], "\[Equal]", 
                 RowBox[{"Length", "[", "B2", "]"}]}], " ", "&&", "  ", 
                "flag"}], ")"}], " ", "||", 
              RowBox[{
               RowBox[{"Length", "[", "B2", "]"}], "\[Equal]", "dimes"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<Break\>\"", "]"}], ";", 
              RowBox[{"Break", "[", "]"}]}], ","}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"B0", "=", "B1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"B1", "=", "B2"}], ";"}], "\[IndentingNewLine]", " ", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"dimes", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "B1", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"time", "=", 
    RowBox[{"TimeUsed", "[", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ReachableSpaceI", "[", 
    RowBox[{"Operas", ",", "Meas", ",", "inibasis", ",", "dimes"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"TimeUsed", "[", "]"}], "-", "time"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MemoryInUse", "[", "]"}], "\[IndentingNewLine]", 
   RowBox[{"MaxMemoryUsed", "[", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.836965631455274*^9, 3.8369659505111227`*^9}, {
   3.836987511972443*^9, 3.8369875844792395`*^9}, {3.836987632534296*^9, 
   3.836987900121166*^9}, {3.836988026239705*^9, 3.8369881066894855`*^9}, {
   3.8370505115184193`*^9, 3.837050522166025*^9}, {3.8370505758374367`*^9, 
   3.837050579733678*^9}, {3.837050640874191*^9, 3.8370507070233936`*^9}, {
   3.83705074961761*^9, 3.8370508933495693`*^9}, 3.8370510352242126`*^9, {
   3.8370517035789666`*^9, 3.8370517949987164`*^9}, {3.8370518362623525`*^9, 
   3.8370518815527663`*^9}, {3.837052110907852*^9, 3.8370521591185627`*^9}, {
   3.8370523410354834`*^9, 3.837052447229764*^9}, {3.8370527731340322`*^9, 
   3.837052797394692*^9}, {3.837052839900796*^9, 3.837052840264345*^9}, {
   3.8370529803941336`*^9, 3.8370530231794*^9}, {3.8370530631075807`*^9, 
   3.837053077458511*^9}, {3.8370531457286844`*^9, 3.8370531548353667`*^9}, {
   3.837053223080741*^9, 3.8370532281313*^9}, {3.837053267607407*^9, 
   3.837053327454124*^9}, {3.837057848067583*^9, 3.837057925217473*^9}, {
   3.837138603849715*^9, 3.837138608598791*^9}, {3.8381553252019453`*^9, 
   3.8381553312806396`*^9}, {3.8383430686051426`*^9, 3.8383430832070594`*^9}, 
   3.8385989571868277`*^9, {3.83859900572753*^9, 3.8385990565501432`*^9}, {
   3.839151167593907*^9, 3.839151190444332*^9}, {3.839151746936478*^9, 
   3.8391517529390793`*^9}, {3.839151801328034*^9, 3.839151815762306*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"2b014594-706c-4ee5-a5c9-7c15bbac0844"],

Cell[BoxData["5.031000000000001`"], "Output",
 CellChangeTimes->{
  3.8383430839264793`*^9, 3.8385989614241734`*^9, 3.8385990575409975`*^9, 
   3.8385990907684526`*^9, 3.839030659671527*^9, 3.8391511611591825`*^9, 
   3.839151191517068*^9, 3.839151753876406*^9, {3.839151808205902*^9, 
   3.839151816668708*^9}},
 CellLabel->
  "Out[262]=",ExpressionUUID->"a89c2a84-a406-4713-93e2-8a3e3585f33c"],

Cell[BoxData["\<\"Break\"\>"], "Print",
 CellChangeTimes->{
  3.8383430839014907`*^9, 3.8385989614201756`*^9, 3.8385990575309067`*^9, 
   3.8385990907574587`*^9, 3.839030659667528*^9, 3.839151161156186*^9, 
   3.8391511915261774`*^9, 3.8391517538804197`*^9, {3.8391518082159204`*^9, 
   3.839151816677122*^9}},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[261]:=",ExpressionUUID->"a4c33af7-5a68-44b6-\
80eb-ce4d9f46844c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["6"]], ",", 
     RowBox[{"-", 
      SqrtBox[
       FractionBox["2", "3"]]}], ",", 
     FractionBox["1", 
      SqrtBox["6"]], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8383430839264793`*^9, 3.8385989614241734`*^9, 3.8385990575409975`*^9, 
   3.8385990907684526`*^9, 3.839030659671527*^9, 3.8391511611591825`*^9, 
   3.839151191517068*^9, 3.839151753876406*^9, {3.839151808205902*^9, 
   3.8391518166811733`*^9}},
 CellLabel->
  "Out[263]=",ExpressionUUID->"78185eb6-7268-409f-b620-2f536cc3b4a9"],

Cell[BoxData["0.`"], "Print",
 CellChangeTimes->{
  3.8383430839014907`*^9, 3.8385989614201756`*^9, 3.8385990575309067`*^9, 
   3.8385990907574587`*^9, 3.839030659667528*^9, 3.839151161156186*^9, 
   3.8391511915261774`*^9, 3.8391517538804197`*^9, {3.8391518082159204`*^9, 
   3.8391518166861563`*^9}},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[261]:=",ExpressionUUID->"d9f73a8b-6da0-4240-\
93cf-99af6d4d868c"],

Cell[BoxData["108422640"], "Output",
 CellChangeTimes->{
  3.8383430839264793`*^9, 3.8385989614241734`*^9, 3.8385990575409975`*^9, 
   3.8385990907684526`*^9, 3.839030659671527*^9, 3.8391511611591825`*^9, 
   3.839151191517068*^9, 3.839151753876406*^9, {3.839151808205902*^9, 
   3.8391518166891537`*^9}},
 CellLabel->
  "Out[265]=",ExpressionUUID->"ec2accc0-27fc-4bc9-9d24-bbc064332083"],

Cell[BoxData["108793088"], "Output",
 CellChangeTimes->{
  3.8383430839264793`*^9, 3.8385989614241734`*^9, 3.8385990575409975`*^9, 
   3.8385990907684526`*^9, 3.839030659671527*^9, 3.8391511611591825`*^9, 
   3.839151191517068*^9, 3.839151753876406*^9, {3.839151808205902*^9, 
   3.839151816691153*^9}},
 CellLabel->
  "Out[266]=",ExpressionUUID->"5452b348-2dc7-4430-acd6-18cc3a8bf297"]
}, Open  ]]
},
WindowSize->{1375, 841},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (2018\:5e743\:670828\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 9628, 207, 1440, "Input",ExpressionUUID->"2b014594-706c-4ee5-a5c9-7c15bbac0844"],
Cell[10211, 231, 395, 7, 32, "Output",ExpressionUUID->"a89c2a84-a406-4713-93e2-8a3e3585f33c"],
Cell[10609, 240, 419, 8, 22, "Print",ExpressionUUID->"a4c33af7-5a68-44b6-80eb-ce4d9f46844c"],
Cell[11031, 250, 888, 27, 75, "Output",ExpressionUUID->"78185eb6-7268-409f-b620-2f536cc3b4a9"],
Cell[11922, 279, 411, 8, 22, "Print",ExpressionUUID->"d9f73a8b-6da0-4240-93cf-99af6d4d868c"],
Cell[12336, 289, 388, 7, 32, "Output",ExpressionUUID->"ec2accc0-27fc-4bc9-9d24-bbc064332083"],
Cell[12727, 298, 386, 7, 32, "Output",ExpressionUUID->"5452b348-2dc7-4430-acd6-18cc3a8bf297"]
}, Open  ]]
}
]
*)

